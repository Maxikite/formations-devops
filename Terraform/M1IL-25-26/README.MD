# ‚òÅÔ∏è Infrastructure AWS - M1 Ing√©nierie Logicielle 2025-2026

Projet Terraform pour d√©ployer une infrastructure AWS compl√®te dans le cadre de la formation M1 Ing√©nierie Logicielle.

## üèóÔ∏è Architecture

### Infrastructure D√©ploy√©e
- **1 instance EC2** avec configuration automatique
- **1 Elastic IP** pour un acc√®s fixe
- **Security Groups** avec r√®gles HTTP/HTTPS/SSH
- **Key Pair** pour l'authentification SSH
- **Page web de d√©monstration**

### R√©gion AWS
- **Zone** : eu-west-3 (Paris)
- **Profil AWS** : tp-terraform-ec2-ipi

## üöÄ Pr√©requis

```bash
# Installation Terraform (macOS)
brew install terraform

# Configuration AWS CLI avec profil sp√©cifique
aws configure --profile tp-terraform-ec2-ipi
```

## üìÅ Structure du Projet

```
M1IL-25-26/
‚îú‚îÄ‚îÄ providers.tf          # Configuration des providers
‚îú‚îÄ‚îÄ variables.tf          # Variables d'entr√©e
‚îú‚îÄ‚îÄ data.tf              # Sources de donn√©es AWS
‚îú‚îÄ‚îÄ 02_eip.tf            # Elastic IP et association
‚îú‚îÄ‚îÄ 03_security_groups.tf # Groupes de s√©curit√©
‚îú‚îÄ‚îÄ 04_key_pair.tf       # Cl√©s SSH
‚îú‚îÄ‚îÄ 10_virtual_machines.tf # Instances EC2
‚îú‚îÄ‚îÄ output.tf            # Valeurs de sortie
‚îú‚îÄ‚îÄ bootstrap.sh         # Script d'initialisation
‚îú‚îÄ‚îÄ index.html           # Page web de d√©monstration
‚îî‚îÄ‚îÄ README.MD            # Documentation
```

## üöÄ D√©ploiement

### Configuration AWS
```bash
# V√©rifier la configuration
aws sts get-caller-identity --profile tp-terraform-ec2-ipi

# Test de connectivit√©
aws ec2 describe-regions --profile tp-terraform-ec2-ipi
```

### Ex√©cution Terraform
```bash
# Initialisation du projet
terraform init

# Validation de la configuration
terraform validate

# Planification des changements
terraform plan

# Application de l'infrastructure
terraform apply

# Affichage des outputs
terraform output

# Destruction (apr√®s utilisation)
terraform destroy
```

## üîß Ressources D√©ploy√©es

### Infrastructure Principale
- **Instance EC2** : Machine virtuelle Ubuntu/Amazon Linux
- **Elastic IP** : Adresse IP publique fixe
- **Security Group** : R√®gles de pare-feu (SSH, HTTP, HTTPS)
- **Key Pair** : Cl√© SSH g√©n√©r√©e automatiquement
- **Bootstrap Script** : Configuration automatique du serveur web

### Configuration R√©seau
- **Ports ouverts** : 22 (SSH), 80 (HTTP), 443 (HTTPS)
- **Acc√®s SSH** : Via cl√© priv√©e g√©n√©r√©e
- **R√©gion** : eu-west-3 (Paris)

## üìä Variables et Personnalisation

### Variables Principales
```hcl
# Exemple de variables.tf
variable "environment" {
  description = "Environment name"
  type        = string
  default     = "development"
}

variable "instance_type" {
  description = "EC2 instance type"
  type        = string
  default     = "t3.micro"
}
```

### Outputs Utiles
Apr√®s d√©ploiement, les informations suivantes sont affich√©es :
- **Adresse IP publique** de l'instance
- **Commande SSH** pour se connecter
- **URL du site web** d√©ploy√©

## üõ°Ô∏è S√©curit√©

### Bonnes Pratiques Impl√©ment√©es
1. **Cl√©s SSH** g√©n√©r√©es automatiquement
2. **Security Groups** restrictifs
3. **Profil AWS** d√©di√© √† la formation
4. **Tags** pour l'identification des ressources

### Acc√®s √† l'Instance
```bash
# R√©cup√©ration de la cl√© priv√©e (g√©n√©r√©e par Terraform)
terraform output -raw private_key > tp-terraform-ipi.pem
chmod 600 tp-terraform-ipi.pem

# Connexion SSH
ssh -i tp-terraform-ipi.pem ubuntu@$(terraform output -raw public_ip)
```

## ÔøΩ V√©rification du D√©ploiement

### Tests de Connectivit√©
```bash
# Test du serveur web
curl http://$(terraform output -raw public_ip)

# V√©rification de l'√©tat des ressources AWS
aws ec2 describe-instances --profile tp-terraform-ec2-ipi \
  --filters "Name=tag:Project,Values=M1IL-Formation"
```

### Monitoring
```bash
# Logs de l'instance (via SSH)
sudo journalctl -u nginx -f

# √âtat des services
sudo systemctl status nginx
```

## üéì Objectifs P√©dagogiques

### Comp√©tences D√©velopp√©es
1. **Infrastructure as Code** avec Terraform
2. **Gestion des resources AWS** (EC2, VPC, Security Groups)
3. **Automatisation** du d√©ploiement
4. **S√©curisation** des acc√®s SSH
5. **Configuration** de serveurs web

### Exercices Avanc√©s
1. **Modification de l'instance** (type, r√©gion)
2. **Ajout de ressources** (Load Balancer, RDS)
3. **Gestion multi-environnements** (dev, staging, prod)
4. **Utilisation de modules** Terraform

## üîÑ Gestion des √âtats

### Backend Local (par d√©faut)
L'√©tat Terraform est stock√© localement dans `terraform.tfstate`

### Backend S3 (optionnel - production)
```hcl
terraform {
  backend "s3" {
    bucket  = "m1il-terraform-state"
    key     = "infrastructure/terraform.tfstate"
    region  = "eu-west-3"
    profile = "tp-terraform-ec2-ipi"
  }
}
```

## ÔøΩ Troubleshooting

### Probl√®mes Courants
1. **Permissions IAM insuffisantes**
   ```bash
   aws iam get-user --profile tp-terraform-ec2-ipi
   ```

2. **R√©gion incorrecte**
   ```bash
   aws configure get region --profile tp-terraform-ec2-ipi
   ```

3. **Quotas AWS d√©pass√©s**
   ```bash
   aws service-quotas get-service-quota --service-code ec2 \
     --quota-code L-1216C47A --profile tp-terraform-ec2-ipi
   ```

## üìö Ressources

- [Terraform AWS Provider](https://registry.terraform.io/providers/hashicorp/aws/)
- [AWS EC2 Documentation](https://docs.aws.amazon.com/ec2/)
- [Terraform Best Practices](https://www.terraform.io/docs/cloud/guides/recommended-practices/)
- [AWS CLI Reference](https://docs.aws.amazon.com/cli/)

